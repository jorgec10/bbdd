--6
SELECT C.IDCASA, C.NOMBRE, COUNT(DISTINCT P.TIPOPLAN) AS NUMPLANES
FROM (CASA C LEFT OUTER JOIN PLAN P ON CASA=IDCASA)
GROUP BY C.IDCASA, C.NOMBRE
ORDER BY C.IDCASA;